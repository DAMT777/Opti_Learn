{% extends "methods/base.html" %}

{% block method_icon %}
<i class="bi bi-shield-check"></i>
{% endblock %}

{% block method_badge %}
<div class="method-hero__badge badge-enhanced"><i class="bi bi-shield-check"></i> Restricciones mixtas</div>
{% endblock %}

{% block method_description %}
<p class="mb-2">Resuelve problemas con <strong>igualdades y desigualdades</strong> usando las condiciones de <strong>Karush-Kuhn-Tucker</strong>. El solver analiza todos los casos posibles y muestra el procedimiento completo.</p>
<div class="method-hero-tags">
  <span class="chip"><i class="bi bi-chevron-double-down"></i> g(x) ≤ 0</span>
  <span class="chip"><i class="bi bi-dash-lg"></i> h(x) = 0</span>
  <span class="chip"><i class="bi bi-puzzle"></i> Complementariedad</span>
</div>
{% endblock %}

{% block method_stats %}
<div class="stat-item"><span class="stat-label">Tipo</span><span class="stat-value">Condiciones KKT</span></div>
<div class="stat-item"><span class="stat-label">Restricciones</span><span class="stat-value">Igualdad + Desigualdad</span></div>
<div class="stat-item"><span class="stat-label">Salida</span><span class="stat-value">x*, λ*, μ*</span></div>
{% endblock %}

{% block method_form_required %}
<div class="form-group-enhanced mb-3">
  <label class="form-label form-label--enhanced"><i class="bi bi-function"></i> Función objetivo (SymPy)</label>
  <textarea id="objective" class="form-control form-control--enhanced" rows="2" placeholder="(x-3)**2 + (y-2)**2">(x-3)**2 + (y-2)**2</textarea>
  <div class="form-hint">Ejemplo: <code>(x-3)**2 + (y-2)**2</code> (minimizar distancia al punto (3,2))</div>
</div>
<div class="form-group-enhanced mb-3">
  <label class="form-label form-label--enhanced"><i class="bi bi-list-ul"></i> Variables (separadas por coma)</label>
  <input id="variables" class="form-control form-control--enhanced" placeholder="x, y" value="x, y">
</div>
<div class="form-group-enhanced mb-3">
  <label class="form-label form-label--enhanced"><i class="bi bi-sliders2"></i> Restricciones (mixtas)</label>
  <div id="constraintsContainer" class="constraints-builder">
    <div class="input-group mb-2 constraint-row">
      <select class="form-select form-control--enhanced constraint-kind" style="max-width: 110px;">
        <option value="le" selected>≤ 0</option>
        <option value="ge">≥ 0</option>
        <option value="eq">= 0</option>
      </select>
      <input type="text" class="form-control form-control--enhanced constraint-input" placeholder="x + y - 4" value="x + y - 4">
      <button type="button" class="btn btn-outline-danger btn-remove-constraint" title="Eliminar"><i class="bi bi-x"></i></button>
    </div>
    <div class="input-group mb-2 constraint-row">
      <select class="form-select form-control--enhanced constraint-kind" style="max-width: 110px;">
        <option value="le">≤ 0</option>
        <option value="ge" selected>≥ 0</option>
        <option value="eq">= 0</option>
      </select>
      <input type="text" class="form-control form-control--enhanced constraint-input" placeholder="x" value="x">
      <button type="button" class="btn btn-outline-danger btn-remove-constraint" title="Eliminar"><i class="bi bi-x"></i></button>
    </div>
    <div class="input-group mb-2 constraint-row">
      <select class="form-select form-control--enhanced constraint-kind" style="max-width: 110px;">
        <option value="le">≤ 0</option>
        <option value="ge" selected>≥ 0</option>
        <option value="eq">= 0</option>
      </select>
      <input type="text" class="form-control form-control--enhanced constraint-input" placeholder="y" value="y">
      <button type="button" class="btn btn-outline-danger btn-remove-constraint" title="Eliminar"><i class="bi bi-x"></i></button>
    </div>
  </div>
  <button type="button" class="btn btn-outline-secondary btn-sm mt-2" id="addConstraintBtn">
    <i class="bi bi-plus-circle"></i> Agregar restricción
  </button>
  <div class="form-hint mt-2">Escribe la expresión, ejemplo: <code>x + y - 4</code> con tipo ≤ 0</div>
</div>
<div class="form-group-enhanced mb-3">
  <div class="form-check form-check--enhanced">
    <input class="form-check-input" type="checkbox" id="isMaximization">
    <label class="form-check-label" for="isMaximization">
      <i class="bi bi-arrow-up-circle text-success me-1"></i> Maximizar (por defecto minimiza)
    </label>
  </div>
</div>
{% endblock %}

{% block method_form_optional %}
<div class="text-muted small">
  <i class="bi bi-info-circle me-1"></i> Este método no requiere parámetros adicionales.
</div>
{% endblock %}

{% block method_tips %}
<li><i class="bi bi-layers text-primary"></i><span>El solver probará <strong>todas las combinaciones</strong> de restricciones activas/inactivas.</span></li>
<li><i class="bi bi-eye text-warning"></i><span>Los multiplicadores <strong>λ ≥ 0</strong> indican qué restricciones están "presionando" la solución.</span></li>
<li><i class="bi bi-rulers text-info"></i><span>La condición de complementariedad <strong>λᵢ·gᵢ(x) = 0</strong> es clave para KKT.</span></li>
{% endblock %}

{% block method_primary_button %}<i class="bi bi-play-fill me-1"></i> Resolver KKT{% endblock %}
