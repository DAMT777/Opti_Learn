/* Contenedores principales (chat y panel) */
.card-soft{ background: var(--d-surface); border-radius: 16px; box-shadow: none; }
body.theme-dark .card-soft{ background: var(--d-surface); }
body.theme-light .card-soft{ background:#ffffff; box-shadow: none; border: none; }
.chat-area{ flex: 1 1 auto; min-height: 0; overflow-y: auto; overflow-x: hidden; padding-bottom: 8px; }
body.is-empty .chat-area{ padding-bottom: 0; }

/* Panel de chat: ocupar alto y fijar footer abajo cuando hay mensajes */
.chat-panel{ display:flex; flex-direction: column; height: calc(100vh - 100px); }
.chat-panel .chat-area{ flex: 1 1 auto; min-height: 0; }
.chat-footer{ position: sticky; bottom: 0; background: transparent; z-index: 5; }
.is-empty .chat-footer{ position: static; }

/* Estado vacío (hero) */
.hero{ margin-top: 10vh; opacity:.9; }
.is-empty #hero{ width: min(var(--chat-input-width), var(--chat-input-max)); max-width: min(var(--chat-input-width), var(--chat-input-max)); margin: 16vh auto 6px; text-align: left; }
.is-empty .card-soft{ box-shadow: none; }
.is-empty section> .border-top{ border-top-color: transparent !important; display:flex !important; justify-content:center; }

/* Indicador de conexión */
.conn-status{ display:flex; align-items:center; gap:6px; font-size:12px; opacity:.85; }
.conn-status .dot{ width:9px; height:9px; border-radius:50%; background:#888; box-shadow:0 0 0 2px rgba(255,255,255,.08) inset; }
.conn-status.connecting .dot{ background:#f0ad4e; }
.conn-status.online .dot{ background:#35c36d; }
.conn-status.offline .dot{ background:#9aa4b1; }

/* Burbujas de chat */
.msg{ display:flex; gap:8px; margin-bottom:10px; align-items:flex-start; }
.msg .bubble{ padding:10px 12px; border-radius: 14px; max-width: 70%; line-height: 1.25; white-space: pre-wrap; }
.msg.assistant .bubble{
  background: transparent !important;
  color: var(--d-ink);
  border: none !important;
  box-shadow: none !important;
  /* Igualar ancho al del input del chat */
  width: 100%;
  max-width: min(var(--chat-input-width), var(--chat-input-max));
}
.msg.user{ justify-content: flex-end; }
.msg.user .bubble{ background: var(--c-p1); color:#fff; border-radius: 18px; margin-right: 12px; }
/* Centrar visualmente las respuestas del asistente */
.msg.assistant{ justify-content: center; }
/* Burbujas del asistente en modo claro: más contraste */
body.theme-light .msg.assistant .bubble{ background: transparent !important; color:#0b2a4a; border: none !important; box-shadow: none !important; }
body.theme-light .msg.user .bubble{ background: var(--c-p1); color:#fff; }

/* Centrar toda el área de conversación y limitar ancho */
#chat{ width:100%; max-width: min(var(--chat-input-width), var(--chat-input-max)); margin: 0 auto; display:flex; flex-direction: column; padding: 4px 0 8px; overflow-x: hidden; }
/* Modo "bloque" para respuestas del asistente (sin globo) */
.msg.assistant .bubble{ background: transparent !important; color: var(--d-ink); border: none !important; box-shadow: none !important; }
body.theme-light .msg.assistant .bubble{ background: transparent !important; color:#0b2a4a; border: none !important; box-shadow: none !important; }

/* Insignia/ícono del header (similar a la marca de la antigua sidebar) */
.chat-header .menu-btn{
  width: 36px; height: 36px; border-radius: 12px; display:inline-flex; align-items:center; justify-content:center;
  border:1px solid #2a4576; background: linear-gradient(180deg, #203b6e, #14264a); color:#9bc3ff;
  box-shadow: 0 4px 12px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.06);
  padding:0; cursor:pointer;
}
.chat-header .menu-btn .inner{ width: 14px; height: 14px; border-radius: 4px; border:2px solid currentColor; opacity:.9; display:inline-block; }
body.theme-light .chat-header .menu-btn{
  border-color:#c9daf6; background: linear-gradient(180deg, #eaf3ff, #d8e8ff); color:#2d5fb8; box-shadow: 0 2px 6px rgba(0,0,0,.08), inset 0 0 0 1px rgba(255,255,255,.65);
}

/* Scrollbars consistentes también en chat */
.chat-area{ scrollbar-width: thin; scrollbar-color: var(--scroll-thumb) var(--scroll-track); }
.chat-area::-webkit-scrollbar{ width: 10px; height: 10px; }
.chat-area::-webkit-scrollbar-track{ background: var(--scroll-track); border-radius: 8px; }
.chat-area::-webkit-scrollbar-thumb{ background-color: var(--scroll-thumb); border-radius: 8px; border: 2px solid transparent; background-clip: padding-box; }
.chat-area::-webkit-scrollbar-thumb:hover{ background-color: var(--scroll-thumb-hover); }

/* Indicador de escritura (tres puntos animados) */
.typing-dots{ display:inline-flex; gap:6px; align-items:center; color: rgba(255,255,255,.85); }
.typing-dots i{ --shift:0px; width:8px; height:8px; border-radius:50%; background: currentColor; opacity:.35; animation: typing-move 1.1s infinite cubic-bezier(.4,.0,.2,1); display:inline-block; will-change: transform, opacity; }
.typing-dots i:nth-child(2){ --shift:6px; animation-delay: .15s; }
.typing-dots i:nth-child(3){ --shift:12px; animation-delay: .3s; }
@keyframes typing-move{ 0%, 100% { transform: translateX(0) translateY(0); opacity:.28; } 35% { transform: translateX(var(--shift)) translateY(-3px); opacity:.95; } 65% { transform: translateX(var(--shift)) translateY(0); opacity:.55; } }
/* Asegurar contraste correcto en modo claro */
body.theme-light .typing-dots{ color: rgba(10,27,48,.75); }
